<style>
    .sorting, .sorting_asc, .sorting_desc {
        background: none;
    }

    table.dataTable thead .sorting,
    table.dataTable thead .sorting_asc,
    table.dataTable thead .sorting_desc {
        background: none;
    }

        table.dataTable thead .sorting:after {
            opacity: 0 !important;
            content: "";
        }

        table.dataTable thead .sorting_asc:after {
            content: "" !important;
        }

        table.dataTable thead .sorting_desc:after {
            content: "" !important;
        }
    /**************************************************************************************************************/
    #Users > thead > tr {
        background-color: #808692;
        font-family: Nunito Sans;
        font-style: normal;
        font-weight: bold;
        font-size: 17px;
        line-height: 115%;
        letter-spacing: 0.01em;
        text-transform: capitalize;
        color: #FFFFFF;
        border-radius: 10px;
    }

        #Users > thead > tr > th {
            border-bottom: none;
        }

            #Users > thead > tr > th:nth-child(1) {
                border-radius: 10px 0 0 0;
            }

            #Users > thead > tr > th:nth-child(4) {
                border-radius: 0 10px 0 0;
            }

    .table-bordered {
        border: none;
    }

    .pagination > .active > a, .pagination > .active > span, .pagination > .active > a:hover, .pagination > .active > span:hover, .pagination > .active > a:focus, .pagination > .active > span:focus {
        z-index: 3;
        color: black;
        cursor: default;
        background-color: #C6F6D5;
        border-color: #C6F6D5;
        margin: 0;
        display: block;
    }

    .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
        color: none !important;
        border: none;
        background-color: none;
        background: none;
        cursor: none;
    }

    .dataTables_wrapper .dataTables_paginate .paginate_button {
        box-sizing: border-box;
        display: inline-block;
        min-width: 1.5em;
        padding: 0.5em 1em;
        margin-left: 0px;
        text-align: center;
        text-decoration: none !important;
        cursor: pointer;
        color: #333 !important;
        border: 1px solid transparent;
        border-radius: 2px;
        padding: 0px;
        cursor: none;
    }

    .table_trade {
        width: 75%;
        margin: 0;
        margin-top: 40px;
    }

    tbody {
        text-align: center
    }

    thead > tr > th {
        text-align: center
    }

    #demoGrid_wrapper {
        padding: 0px !important;
    }

    .info_action {
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        padding: 1px 2px;
        width: 34px;
        height: 34px;
        background: #C6F6D5;
        border-radius: 45px;
    }

    .edit_action {
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        padding: 1px 2px;
        width: 34px;
        height: 34px;
        background: #EBE66E;
        border-radius: 45px;
    }

    .delete_action {
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        padding: 1px 2px;
        width: 34px;
        height: 34px;
        background: #FD4343;
        border-radius: 45px;
    }

    .Reset_action {
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        padding: 1px 2px;
        width: 34px;
        height: 34px;
        background: #F96D31;
        border-radius: 45px;
    }

    .action_btn {
        display: flex;
        align-items: center;
        justify-content: space-evenly
    }

    table.dataTable.no-footer {
        -webkit-box-shadow: 4px 4px 19px 0px rgba(0,0,0,0.51);
        box-shadow: 4px 4px 19px 0px rgba(0,0,0,0.15);
        border-radius: 10px 10px 0 0;
        border-bottom: 1px solid #dbdbdb;
    }

    .EDIT {
        width: 227px;
    }
    .table_trade {
        width: 100%;
    }
</style>
<div class="btn_action">
    <a class="button EDIT hover_edit" onclick="add_new_user()">
        Add new user
        <img src="~/img/Manage/add_health.svg" />
    </a>
</div>
<div class="table_trade">
    <table id="Users" class="table table-striped table-bordered " width="100%" cellspacing="0">
        <thead>
            <tr>
                <th class="col_name" style="width:240px;">ID</th>
                <th>RoleId</th>
                <th class="col_name" style="width:255px;">Name</th>
                <th class="col_name" style="width:230px;">User Name</th>
                <th class="col_name" style="width:200px;  border-radius: 0 0 0 0;">Email</th>
                <th class="col_name" style="width:155px;">role</th>
                <th class="col_name" style="width:170px; border-radius: 0 10px 0 0;">Action</th>
            </tr>
        </thead>
    </table>
</div>
<script>
    $(document).ready(
        //load table Users******************************************************************
        function data_table() {
            $('#Users').dataTable({
                "processing": true,
                "serverSide": true,
                "filter": true,
                "orderMulti": false,
                "rowReorder": true,
                "pageLength": 3,

                "ajax": {
                    "url": "/Manage/LoadAllUsersRoles",
                    "type": "POST",
                    "datatype": "json"
                },

                "columnDefs":
                    [{
                        "targets": [0],
                        "visible": true,
                        "searchable": false
                    },
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [2],
                        "searchable": true,
                        "orderable": false
                    },
                    {
                        "targets": [3],
                        "searchable": true,
                        "orderable": false
                    },
                    {
                        "targets": [4],
                        "searchable": true,
                        "orderable": false
                    },
                    {
                        "targets": [5],
                        "searchable": true,
                        "orderable": false
                    },
                    {
                        "targets": [6],
                        "searchable": true,
                        "orderable": false
                    }
                    ],
                "columns": [
                    { "data": "id", "Name": "ID", "autoWidth": true },
                    { "data": "role_id", "Name": "RoleId", "autoWidth": true },
                    { "data": "name", "Name": "Name", "autoWidth": true },
                    { "data": "UserName", "Name": "User Name", "autoWidth": true },
                    { "data": "Email", "Name": "Email", "autoWidth": true },
                    { "data": "role", "Name": "role", "autoWidth": true },
                    {
                        "render": function (data, type, row, meta) {
                            return '<div class="action_btn"><a class="info_action" data-toggle="tooltip" title="More Information" style="cursor:pointer" onclick="LoadUserInformation(' + "'" + row.id + "'" + ')" ><img src="/img/Manage/table action/More_Info.svg" /> </a>' +
                                '<a class="edit_action Edit" data-toggle="tooltip" title="Edit User Information" value="' + row.id + '" style="cursor:pointer" onclick="Edit_User_info(' + "'" + row.id + "'" + ')" ><img src="/img/Manage/table action/edit_action.svg" /></a>' +
                                '<a class="delete_action" data-toggle="tooltip" title="Delete User Information" value="' + row.id + '" style="cursor:pointer" onclick="Delete_User(' + "'" + row.id + "'" + ',' + "'" + row.role + "'" + ',' + "'" + row.UserName + "'" + ');"><img src="/img/Manage/table action/delete_action.svg" /></a>' +
                                '<a class="Reset_action" data-toggle="tooltip" title="Reset User PassWord" value="' + row.id + '" style="cursor:pointer" onclick="Reset_Password(' + "'" + row.id + "'" + ',' + "'" + row.name + "'" + ')" ><img src = "/img/Manage/Reset_pass.svg" /> </a></div > ';

                        }
                    }
                ]
            });
        });



    //open modal for adding new user********************************************************
    function add_new_user() {
        $('.pass_div').show();
        document.querySelector('.change_titer_user').innerHTML = "Add New User";
        document.querySelector('.Name_span').innerHTML = null;
        document.querySelector('.username_span').innerHTML = null;
        document.querySelector('.Email_span').innerHTML = null;
        document.querySelector('.Password_span').innerHTML = null;
        document.querySelector('.Gender_span').innerHTML = null;
        document.querySelector('.Age_span').innerHTML = null;
        document.querySelector('.Role_span').innerHTML = null;
        $('.id').val(null);
        $('.Name_new').val(null);
        $('.Username_new').val(null);
        $('.Email_new').val(null);
        $('.Password_new').val(null);
        $('.age_new').val(null);
        $('.Gender_new option').prop('selected', false);
        $('.Roles_new option').prop('selected', false);
        $('#Add_New_User').modal("show");
    }



    //open modal for Editing user***********************************************************
    function Edit_User_info(id) {
        $.ajax({
            url: "/Manage/LoadUserForEdit",
            type: "POST",
            data: { "id": id }
        }).done(function (data) {
            $('.pass_div').hide();
            document.querySelector('.change_titer_user').innerHTML = 'Edit <span style="color:#348B5E">"' + data.Name + '"</span> Information';
            document.querySelector('.Name_span').innerHTML = null;
            document.querySelector('.username_span').innerHTML = null;
            document.querySelector('.Email_span').innerHTML = null;
            document.querySelector('.Password_span').innerHTML = null;
            document.querySelector('.Gender_span').innerHTML = null;
            document.querySelector('.Age_span').innerHTML = null;
            document.querySelector('.Role_span').innerHTML = null;
            $('.id').val(data.Id);
            $('.Name_new').val(data.Name);
            $('.Username_new').val(data.UserName);
            $('.Email_new').val(data.Email);
            $('.age_new').val(data.age);
            $('.Gender_new').val(data.Gender);
            $('.Roles_new').val(data.Roles[0].RoleId);
            $('#Add_New_User').modal("show");
        })

    }



    //open resetPassword modal *************************************************************
    function Reset_Password(id, name) {
        document.querySelector('.set_by_admin').innerHTML = "Set password for user" + '<span style="color:#348B5E">"' + name + '"</span>';
        $('.NewPassword').val(null);
        $('.ConfirmPassword').val(null);
        $('.alert-danger-password').remove();
        $('.SetPasswordId').val(id);
        $('#SetPassworModal').modal("show");
    }





    //load delete alert modal****************************************************************
    function Delete_User(id, role, name) {
        document.querySelector('.message_delete_User').innerHTML = null;
        document.querySelector('.message_delete_User').innerHTML = "are you sure you want to delete User Name " + '<span style="color:#348B5E">"' + name + '"</span>';
        document.querySelector('.btn_Delete_user').value = id;
        document.querySelector('.btn_Delete_user').name = role;
        if (role == "pharmacists") {
            $('.add_messege').remove();
            $(".add_par").append("<p class='message_delete add_messege' style='color: red; padding-top: 0px; '>If you delete a Pharmacist all his/her certification information will be deleted</p>");
        }
        else {
            $('.add_messege').remove();
            
        }
        
        $('#DeleteUser').modal("show");
    }




    //load modal for edit****************************************************************
    function LoadUserInformation(id) {
        $.ajax({
            url: "/Manage/LoadUserForModreInfo",
            type: "POST",
            data: { "id": id }
        }).done(function (data) {
            $('.pass_div').hide();
            document.querySelector('.Info_titer_user').innerHTML = 'More Information About <span style="color:#348B5E">"' + data[0].Name + '"</span>';

            document.querySelector('.Name_info').innerHTML = data[0].Name;
            document.querySelector('.UserName_info').innerHTML = data[0].UserName;
            document.querySelector('.Email_info').innerHTML = data[0].Email;
            document.querySelector('.Age_info').innerHTML = data[0].Age;
            document.querySelector('.gender_info').innerHTML = data[0].gender;
            document.querySelector('.Roles_info').innerHTML = data[0].RoleName;
            $('#User_more_info').modal("show");
        })
    }

</script>


<link href="~/Content/DataTables/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/DataTables/css/responsive.bootstrap.min.css" rel="stylesheet" />
<script src="~/Scripts/DataTables/jquery.dataTables.min.js"></script>
<script src="~/Scripts/DataTables/dataTables.bootstrap4.min.js"></script>
